5       0000  COPY   START  0
10      0000  FIRST  STL    RETADR          0
15      0003         LDB    #LENGTH         0
20                   BASE   LENGTH
25      0006  CLOOP  +JSUB  RDREC           0
30      000A         LDA    LENGTH          0
35      000D         COMP   #0              0
40      0010         JEQ    ENDFIL          0
45      0013         +JSUB  WRREC           0
50      0017         J      CLOOP           0
55      001A  ENDFIL LDA    EOF             0
60      001D         STA    BUFFER          0
65      0020         LDA    #3              0
70      0023         STA    LENGTH          0
75      0026         +JSUB  WRREC           0
80      002A         J      @RETADR         0
85      002D  EOF    BYTE   C'EOF'          454F46
90      0030  RETADR RESW   1
95      0033  LENGTH RESW   1
100     0036  BUFFER RESB   4096
105           .
110           .      SUBROUTINE TO READ RECORD INTO BUFFER
115           .
120     1036  RDREC  CLEAR  X               B410
125     1038         CLEAR  A               B400
130     103A         CLEAR  S               B440
135     103C         +LDT   #4096           0
140     1040  RLOOP  TD     INPUT           0
145     1043         JEQ    RLOOP           0
150     1046         RD     INPUT           0
155     1049         COMPR  A, S            A004
160     104B         JEQ    EXIT            0
165     104E         STCH   BUFFER, X       0
170     1051         TIXR   T               B850
175     1053         JLT    RLOOP           0
180     1056  EXIT   STX    LENGTH          0
185     1059         RSUB                   0
190     105C  INPUT  BYTE   X'F1'           F1
195           .
200           .      SUBROUTINE TO WRITE RECORD FROM BUFFER
205           .
210     105D  WRREC  CLEAR  X               B410
215     105F         LDT    LENGTH          0
220     1062  WLOOP  TD     OUTPUT          0
225     1065         JEQ    WLOOP           0
230     1068         LDCH   BUFFER, X       0
235     106B         WD     OUTPUT          0
240     106E         TIXR   T               B850
245     1070         JLT    WLOOP           0
250     1073         RSUB                   0
255     1076  OUTPUT BYTE   X'05'           05
260                  END    FIRST
